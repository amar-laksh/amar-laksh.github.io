<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ffffff name=theme-color><meta content=#da532c name=msapplication-TileColor><link crossorigin href=https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.1/css/academicons.min.css integrity=sha384-FIue+PI4SsI9XfHCz8dBLg33b0c1fMJgNU3X//L26FYbGnlSEfWmNT7zgWc2N9b6 rel=stylesheet><link integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css rel=stylesheet><link href=https://amar-laksh.github.io/deep-thought.css rel=stylesheet><title>
    
The Codeless Text | Writeups for Google CTF 2019: My first CTF (Kinda) - Part 2

  </title><link crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs rel=stylesheet><script crossorigin defer integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js></script><script crossorigin defer integrity=sha384-jiBVvJ8NGGj5n7kJaiWwWp9AjC+Yh8rhZY3GtAX8yU28azcLgoRo4oukO87g7zDT src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mathtex-script-type.min.js></script><script crossorigin defer integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js></script><body class=has-background-white><nav aria-label="section navigation" class="navbar is-light" role=navigation><div class=container><div class=navbar-brand><a class="navbar-item is-size-5 has-text-weight-bold" href=https://amar-laksh.github.io>The Codeless Text</a><a class="navbar-burger burger" aria-expanded=false aria-label=menu data-target=navMenu role=button> <span aria-hidden=true></span> <span aria-hidden=true></span> <span aria-hidden=true></span> </a></div><div class=navbar-menu id=navMenu><div class="navbar-end has-text-centered"><a class="navbar-item has-text-weight-semibold" href=https://amar-laksh.github.io/> Home </a><a class="navbar-item has-text-weight-semibold" href=https://amar-laksh.github.io/posts> Posts </a><a class="navbar-item has-text-weight-semibold" href=https://amar-laksh.github.io/resume.pdf> Resume </a><a class=navbar-item data-target=#search-modal id=nav-search title=Search> <span class=icon> <i class="fas fa-search"></i> </span> </a><a title="Switch to dark theme" class=navbar-item id=dark-mode> <span class=icon> <i class="fas fa-adjust"></i> </span> </a></div></div></div></nav><section class=section><div class=container><div class=columns><div class="column is-8 is-offset-2"><article class=box><h1 class=title>Writeups for Google CTF 2019: My first CTF (Kinda) - Part 2</h1><p class=subtitle><div class="columns is-multiline is-gapless"><div class="column is-8"><span class="icon-text has-text-grey"> <span class=icon> <i class="fas fa-user"></i> </span> <span>Amar Lakshya published on</span> <span class=icon> <i class="far fa-calendar-alt"></i> </span> <span><time datetime=2019-06-29>June 29, 2019</time></span> </span></div><div class="column is-4 has-text-right-desktop"><span class="icon-text has-text-grey"> <span class=icon> <i class="far fa-clock"></i> </span> <span>3 min,</span> <span class=icon> <i class="fas fa-pencil-alt"></i> </span> <span>440 words</span> </span></div><div class=column></div><div class="column has-text-right-desktop"></div></div><div class="content mt-2"><h2 id=work-computer-sandbox>Work Computer - Sandbox</h2><p><img alt=work_computer.png src=/images/ctf_images/google_2019/work_computer.png><p>We connect to the given server on the given port and see what we are up against by using netcat (<code>nc readme.ctfcompetition.com 1337</code>):<pre style=background:#2b303b;color:#c0c5ce><code><span>> help
</span><span>Alien's shell
</span><span>Type program names and arguments, and hit enter.
</span><span>The following are built in:
</span><span>  cd
</span><span>  help
</span><span>  exit
</span><span>Use the man command for information on other programs.
</span><span>>
</span></code></pre><p>So clearly this is some kind of shell, let's try doing an ls:<pre style=background:#2b303b;color:#c0c5ce><code><span>ls -l
</span><span>total 8
</span><span>----------    1 1338     1338            33 Jul  4 12:07 ORME.flag
</span><span>-r--------    1 1338     1338            28 Jul  4 12:07 README.flag
</span></code></pre><p>Now we can see that we can at least read <code>README.flag</code>, trying to do that we find:<pre style=background:#2b303b;color:#c0c5ce><code><span>> cat README.flag
</span><span>error: No such file or directory
</span></code></pre><p>So we find we can't use <code>cat</code> or any other kind of usual command to output the flag. How do we know this? Let's try listing all the commands avaialabe in the <code>/usr/bin/</code>. We quickly find that there are no commands such as <code>cat</code>, <code>less</code> etc.<p>Okay so let's try enumerating all the interesting directories where we can find some obscure program to output our flag:<pre style=background:#2b303b;color:#c0c5ce><code><span>> ls -l /bin /sbin /usr/bin /usr/sbin                                         
</span><span>/bin:
</span><span>total 800
</span><span>lrwxrwxrwx    1 65534    65534           12 May  9 20:49 arch -> /bin/busybox
</span><span>-rwxr-xr-x    1 65534    65534       796240 Jan 24 07:45 busybox
</span><span>lrwxrwxrwx    1 65534    65534           12 May  9 20:49 chgrp -> /bin/busybox
</span><span>lrwxrwxrwx    1 65534    65534           12 May  9 20:49 chown -> /bin/busybox
</span><span>lrwxrwxrwx    1 65534    65534           12 May  9 20:49 conspy -> /bin/busybox
</span><span>..............
</span><span>/sbin:
</span><span>total 228
</span><span>lrwxrwxrwx    1 65534    65534           12 May  9 20:49 acpid -> /bin/busybox
</span><span>lrwxrwxrwx    1 65534    65534           12 May  9 20:49 adjtimex -> /bin/busybox
</span><span>..............
</span><span>/usr/bin:
</span><span>total 1984
</span><span>lrwxrwxrwx    1 65534    65534           12 May  9 20:49 [ -> /bin/busybox
</span><span>lrwxrwxrwx    1 65534    65534           12 May  9 20:49 [[ -> /bin/busybox
</span><span>..............
</span><span>-rwxr-xr-x    1 65534    65534        25216 Mar 19 09:56 iconv
</span><span>..............
</span><span>-rwxr-xr-x    1 65534    65534        83744 Nov 15  2018 scanelf
</span><span>..............
</span><span>/usr/sbin:
</span><span>total 16
</span><span>lrwxrwxrwx    1 65534    65534           12 May  9 20:49 addgroup -> /bin/busybox
</span><span>lrwxrwxrwx    1 65534    65534           12 May  9 20:49 adduser -> /bin/busybox
</span><span>..............
</span><span>> 
</span></code></pre><p>Looking through the list I happen to come across two commands I have not seen or noticed before! The commands are: <a rel="noopener nofollow noreferrer" href=https://linux.die.net/man/1/shuf target=_blank>shuf</a> and <a rel="noopener nofollow noreferrer" href=https://linux.die.net/man/1/iconv target=_blank>iconv</a>. We look up the man pages for them and find that both of them write file contents to stdout! Exactly what we want to do:<pre style=background:#2b303b;color:#c0c5ce><code><span>> shuf README.flag
</span><span>CTF{4ll_D474_5h4ll_B3_Fr33}
</span><span>
</span><span>> iconv /challenge/README.flag
</span><span>CTF{4ll_D474_5h4ll_B3_Fr33}
</span></code></pre><p>Here's our flag!<h2 id=friendspacebookplusallaccessredpremium-com-reversing>FriendSpaceBookPlusAllAccessRedPremium.com - Reversing</h2><p><img alt=friends.png src=/images/ctf_images/google_2019/friends.png></div></article></div></div></div></section><section class=modal id=search-modal><div class=modal-background></div><div class=modal-card><header class=modal-card-head><p class=modal-card-title>Search</header><section class=modal-card-body><div class="field mb-2"><div class=control><input placeholder="Search this website." class=input id=search type=search></div></div><div class=search-results><div class=search-results__items></div></div></section></div><button class="modal-close is-large" aria-label=close></button></section><section class=section><div class=container><div class="columns is-centered"><div class="column is-8"><nav class=level><div class="level-item has-text-centered"><a class="button is-black is-outlined" href=https://amar-laksh.github.io/posts/qt5-package-as-ros2-node/> <span class="icon mr-2"> <i class="fas fa-arrow-circle-left"></i> </span> Convert/Run Qt5 app into/as a ROS2 package </a></div><div class="level-item has-text-centered"><a class="button is-black is-outlined" href=https://amar-laksh.github.io/posts/google-ctf-writeups-part-1/> Writeups for Google CTF 2019: My first CTF (Kinda) - Part 1<span class="icon ml-2"> <i class="fas fa-arrow-circle-right"></i> </span> </a></div></nav></div></div></div></section><footer class="footer py-4"><div class="content has-text-centered"><p>Built with <span class=icon-text> <span class=icon> <i class="fas fa-code"></i> </span> <span>code</span> </span> and <span class=icon-text> <span class=icon> <i class="fas fa-heart"></i> </span> <span>love</span> </span><p>Powered by <span class=icon-text> <span class=icon> <i class="fas fa-power-off"></i> </span> <span>zola</span> </span></div></footer><script src=https://amar-laksh.github.io/elasticlunr.min.js></script><script src=https://amar-laksh.github.io/search_index.en.js></script><script src=https://amar-laksh.github.io/js/site.js></script>