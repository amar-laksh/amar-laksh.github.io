<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#ffffff name=theme-color><meta content=#da532c name=msapplication-TileColor><link crossorigin href=https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.1/css/academicons.min.css integrity=sha384-FIue+PI4SsI9XfHCz8dBLg33b0c1fMJgNU3X//L26FYbGnlSEfWmNT7zgWc2N9b6 rel=stylesheet><link integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css rel=stylesheet><link href=https://amar-laksh.github.io/deep-thought.css rel=stylesheet><title>
    
The Codeless Text | Setting up a Kali docker container for HackTheBox and other stuff.

  </title><link crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs rel=stylesheet><script crossorigin defer integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js></script><script crossorigin defer integrity=sha384-jiBVvJ8NGGj5n7kJaiWwWp9AjC+Yh8rhZY3GtAX8yU28azcLgoRo4oukO87g7zDT src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mathtex-script-type.min.js></script><script crossorigin defer integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js></script><body class=has-background-white><nav aria-label="section navigation" class="navbar is-light" role=navigation><div class=container><div class=navbar-brand><a class="navbar-item is-size-5 has-text-weight-bold" href=https://amar-laksh.github.io>The Codeless Text</a><a class="navbar-burger burger" aria-expanded=false aria-label=menu data-target=navMenu role=button> <span aria-hidden=true></span> <span aria-hidden=true></span> <span aria-hidden=true></span> </a></div><div class=navbar-menu id=navMenu><div class="navbar-end has-text-centered"><a class="navbar-item has-text-weight-semibold" href=https://amar-laksh.github.io/> Home </a><a class="navbar-item has-text-weight-semibold" href=https://amar-laksh.github.io/posts> Posts </a><a class="navbar-item has-text-weight-semibold" href=https://amar-laksh.github.io/resume.pdf> Resume </a><a class=navbar-item data-target=#search-modal id=nav-search title=Search> <span class=icon> <i class="fas fa-search"></i> </span> </a><a title="Switch to dark theme" class=navbar-item id=dark-mode> <span class=icon> <i class="fas fa-adjust"></i> </span> </a></div></div></div></nav><section class=section><div class=container><div class=columns><div class="column is-8 is-offset-2"><article class=box><h1 class=title>Setting up a Kali docker container for HackTheBox and other stuff.</h1><p class=subtitle><div class="columns is-multiline is-gapless"><div class="column is-8"><span class="icon-text has-text-grey"> <span class=icon> <i class="fas fa-user"></i> </span> <span>Amar Lakshya published on</span> <span class=icon> <i class="far fa-calendar-alt"></i> </span> <span><time datetime=2019-08-24>August 24, 2019</time></span> </span></div><div class="column is-4 has-text-right-desktop"><span class="icon-text has-text-grey"> <span class=icon> <i class="far fa-clock"></i> </span> <span>2 min,</span> <span class=icon> <i class="fas fa-pencil-alt"></i> </span> <span>247 words</span> </span></div><div class=column></div><div class="column has-text-right-desktop"></div></div><div class="content mt-2"><p>You wanna practice and that pesky virtual image is too hard/tiresome/pesky to setup and run on your machine?<p>Well, what about a Kali Linux docker container that you can use all your tools from and also run GUI apps if you're so inclined?!<h2 id=step-1-download-run-the-kali-linux-docker-image>Step - 1: Download & Run the Kali Linux Docker image</h2><p>Here's the official link and honestly it covers almost everything: <a rel="noopener nofollow noreferrer" href=https://www.kali.org/news/official-kali-linux-docker-images/ target=_blank>Kali Linux Docker</a><h2 id=step-2-setup-your-kali-with-meta-packages>Step - 2: Setup your Kali with meta-packages</h2><p>Another great official link: <a rel="noopener nofollow noreferrer" href=https://www.kali.org/news/kali-linux-metapackages/ target=_blank>Kali meta-packages</a><h2 id=step-3-allow-vpn-connections>Step - 3: Allow VPN connections!</h2><p>We all know how handy and important VPNs are. So adding the following command when running your docker container allows connections to pass through(also allowing ipv6):<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>--cap-add</span><span>=</span><span style=color:#a3be8c>NET_ADMIN </span><span style=color:#bf616a>--device</span><span> /dev/net/tun</span><span style=color:#bf616a>  --sysctl</span><span> net.ipv6.conf.all.disable_ipv6=0
</span></code></pre><h2 id=step-4-allow-gui-apps-to-access-x-server>Step - 4: Allow GUI apps to access X server!</h2><p>Install <code>xhost</code> package from your distribution package manager (mostly it's just named <code>xorg-xhost</code>) and run the following command to allow remote hosts to connect to the X server before starting your docker container with:<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>xhost+
</span></code></pre><p>for the docker GUI X clients we need to add the following arguments to setup the X connection properly:<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>-e</span><span> DISPLAY=:0</span><span style=color:#bf616a> -v</span><span> /tmp/.X11-unix:/tmp/.X11-unix
</span></code></pre><p>Tip: Remember to deny remote hosts after closing your docker container! ( just run <code>xhost -</code> for it)<h2 id=step-5-profit>Step - 5: Profit!</h2><p>Here's the complete command:<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>xhost</span><span> + &&\
</span><span style=color:#bf616a>docker</span><span> run</span><span style=color:#bf616a> -ti --cap-add</span><span>=NET_ADMIN</span><span style=color:#bf616a> --device</span><span> /dev/net/tun \
</span><span style=color:#bf616a>--sysctl</span><span> net.ipv6.conf.all.disable_ipv6=0 \
</span><span style=color:#bf616a>-e</span><span> DISPLAY=:0</span><span style=color:#bf616a> -v</span><span> /tmp/.X11-unix:/tmp/.X11-unix \
</span><span>YOUR_DOCKER_IMAGE_NAME /bin/bash && </span><span style=color:#bf616a>xhost</span><span> -
</span></code></pre><p>Here's a link for a nifty little script that packages everything (My docker image is named <code>kali_pt</code>):<p><a rel="noopener nofollow noreferrer" href=https://github.com/amar-laksh/kali_pt/blob/master/kali.sh target=_blank>https://github.com/amar-laksh/kali_pt/blob/master/kali.sh</a></div></article></div></div></div></section><section class=modal id=search-modal><div class=modal-background></div><div class=modal-card><header class=modal-card-head><p class=modal-card-title>Search</header><section class=modal-card-body><div class="field mb-2"><div class=control><input placeholder="Search this website." class=input id=search type=search></div></div><div class=search-results><div class=search-results__items></div></div></section></div><button class="modal-close is-large" aria-label=close></button></section><section class=section><div class=container><div class="columns is-centered"><div class="column is-8"><nav class=level><div class="level-item has-text-centered"><a class="button is-black is-outlined" href=https://amar-laksh.github.io/posts/google-ctf-writeups-part-1/> <span class="icon mr-2"> <i class="fas fa-arrow-circle-left"></i> </span> Writeups for Google CTF 2019: My first CTF (Kinda) - Part 1 </a></div><div class="level-item has-text-centered"><a class="button is-black is-outlined" href=https://amar-laksh.github.io/posts/lingering/> Lingering<span class="icon ml-2"> <i class="fas fa-arrow-circle-right"></i> </span> </a></div></nav></div></div></div></section><footer class="footer py-4"><div class="content has-text-centered"><p>Built with <span class=icon-text> <span class=icon> <i class="fas fa-code"></i> </span> <span>code</span> </span> and <span class=icon-text> <span class=icon> <i class="fas fa-heart"></i> </span> <span>love</span> </span><p>Powered by <span class=icon-text> <span class=icon> <i class="fas fa-power-off"></i> </span> <span>zola</span> </span></div></footer><script src=https://amar-laksh.github.io/elasticlunr.min.js></script><script src=https://amar-laksh.github.io/search_index.en.js></script><script src=https://amar-laksh.github.io/js/site.js></script>