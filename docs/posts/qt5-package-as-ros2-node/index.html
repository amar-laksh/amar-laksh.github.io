<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <meta content="#ffffff" name="theme-color" />
  <meta content="#da532c" name="msapplication-TileColor" />

  
  
  
  
  

  <link href="https://cdnjs.cloudflare.com/ajax/libs/galleria/1.6.1/themes/folio/galleria.folio.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link href='https://api.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css' rel='stylesheet' />
  <link href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css" rel="stylesheet" />
  <link href="https://amar-laksh.github.io/deep-thought.css" rel="stylesheet" />

  <title>
    
The Codeless Text | Convert&#x2F;Run Qt5 app into&#x2F;as a ROS2 package

  </title>

  

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/mathtex-script-type.min.js" integrity="sha384-LJ2FmexL77rmGm6SIpxq7y+XA6bkLzGZEgCywzKOZG/ws4va9fUVu2neMjvc3zdv" crossorigin="anonymous"></script>
  
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous" onload="renderMathInElement(document.body, {
				delimiters: [
					{left: '$$', right: '$$', display: true},
					{left: '$', right: '$', display: false},
					{left: '\\(', right: '\\)', display: false},
					{left: '\\[', right: '\\]', display: true}
				]
			});"></script>
  
  
</head>

<body class="has-background-white">
  <nav aria-label="section navigation" class="navbar is-light" role="navigation">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item is-size-5 has-text-weight-bold" href="https:&#x2F;&#x2F;amar-laksh.github.io">The Codeless Text</a>
        <a aria-expanded="false" aria-label="menu" class="navbar-burger burger" data-target="navMenu" role="button">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
      <div class="navbar-menu" id="navMenu">
        <div class="navbar-end has-text-centered">
          
          
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;amar-laksh.github.io&#x2F;">
            Home
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;amar-laksh.github.io&#x2F;posts">
            Posts
          </a>
          
          <a class="navbar-item has-text-weight-semibold" href="https:&#x2F;&#x2F;amar-laksh.github.io&#x2F;tags">
            Tags
          </a>
          
          
          
          <a class="navbar-item" id="nav-search" title="Search" data-target="#search-modal">
            <span class="icon">
              <i class="fas fa-search"></i>
            </span>
          </a>
          <a class="navbar-item" id="dark-mode" title="Switch to dark theme">
            <span class="icon">
              <i class="fas fa-adjust"></i>
            </span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  
<section class="section">
  <div class="container">
    <div class="columns">
      <div class="column is-8 is-offset-2">
        <article class="box">
          <h1 class="title">
            Convert&#x2F;Run Qt5 app into&#x2F;as a ROS2 package
          </h1>
          <p class="subtitle"></p>
          <div class="columns is-multiline is-gapless">
            <div class="column is-8">
              
<span class="icon-text has-text-grey">
  <span class="icon">
    <i class="fas fa-user"></i>
  </span>
  <span>Amar Lakshya published on</span>
  <span class="icon">
    <i class="far fa-calendar-alt"></i>
  </span>
  <span><time datetime="2018-06-24">June 24, 2018</time></span>
</span>

            </div>
            <div class="column is-4 has-text-right-desktop">
              
<span class="icon-text has-text-grey">
  <span class="icon">
    <i class="far fa-clock"></i>
  </span>
  <span>4 min,</span>
  <span class="icon">
    <i class="fas fa-pencil-alt"></i>
  </span>
  <span>628 words</span>
</span>

            </div>
            <div class="column">
              
            </div>
            <div class="column has-text-right-desktop">
              
            </div>
          </div>
          <div class="content mt-2">
            <p>So you want to run your Qt5 app as a ros2 node?, Here we go</p>
<h3 id="step-1-build-the-qt5-app">Step - 1: Build the Qt5 App</h3>
<p>The first thing you need to do is to convert your Qt5 app to a ros2 package so that you can build it using: <code>ament build</code>.</p>
<p>Let's make an example Qt5 app to showcase this!</p>
<p>After installing Qt creator we get two types of Qt Quick apps we can make. They differ on the build system they use:</p>
<ul>
<li>qmake apps</li>
<li>cmake apps</li>
</ul>
<p>Let's have a look at how to make each one of them:</p>
<ul>
<li>
<p>This is the qmake build system app -
<img src="/images/qt5_qmake_app.gif" alt="Qt5 qmake app" /></p>
</li>
<li>
<p>This is the cmake build system app -
<img src="/images/qt5_cmake_app.gif" alt="Qt5 cmake app" /></p>
</li>
</ul>
<h3 id="step-2-depending-on-the-build-format-create-extend-cmakelists-txt">Step - 2: Depending on the build format, create/extend CMakeLists.txt</h3>
<ul>
<li>Here we have two different steps for the Qt5 app depending on the build system you chose, you'll get these directory structures:</li>
</ul>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">-</span><span> CMake:
</span><span style="color:#96b5b4;">.
</span><span style="color:#bf616a;">├──</span><span> CMakeLists.txt
</span><span style="color:#bf616a;">├──</span><span> CMakeLists.txt.user
</span><span style="color:#bf616a;">├──</span><span> main.cpp
</span><span style="color:#bf616a;">├──</span><span> main.qml
</span><span style="color:#bf616a;">├──</span><span> Page1Form.ui.qml
</span><span style="color:#bf616a;">├──</span><span> Page2Form.ui.qml
</span><span style="color:#bf616a;">├──</span><span> qml.qrc
</span><span style="color:#bf616a;">└──</span><span> qtquickcontrols2.conf
</span><span style="color:#bf616a;">0</span><span> directories, 8 files
</span><span style="color:#bf616a;">{</span><span>% endhighlight%}
</span><span style="color:#bf616a;">-</span><span> qmake
</span><span style="color:#bf616a;">{</span><span>% highlight bash %}
</span><span style="color:#96b5b4;">.
</span><span style="color:#bf616a;">├──</span><span> demo.pro
</span><span style="color:#bf616a;">├──</span><span> demo.pro.user
</span><span style="color:#bf616a;">├──</span><span> main.cpp
</span><span style="color:#bf616a;">├──</span><span> main.qml
</span><span style="color:#bf616a;">├──</span><span> Page1Form.ui.qml
</span><span style="color:#bf616a;">├──</span><span> Page2Form.ui.qml
</span><span style="color:#bf616a;">├──</span><span> qml.qrc
</span><span style="color:#bf616a;">└──</span><span> qtquickcontrols2.conf
</span><span style="color:#bf616a;">0</span><span> directories, 8 files
</span><span>
</span></code></pre>
<ul>
<li>Smply open the CMakeLists.txt to edit and in the case of a qmake build create <code>CMakeLists.txt</code>, make it look like this:</li>
</ul>
<pre data-lang="cmake" style="background-color:#2b303b;color:#c0c5ce;" class="language-cmake "><code class="language-cmake" data-lang="cmake"><span style="color:#96b5b4;">cmake_minimum_required</span><span>(</span><span style="color:#bf616a;">VERSION </span><span>3.5)
</span><span style="color:#96b5b4;">project</span><span>(demo)
</span><span>
</span><span style="color:#96b5b4;">set </span><span>(</span><span style="color:#bf616a;">CMAKE_CXX_STANDARD </span><span>14)
</span><span style="color:#b48ead;">if</span><span>(NOT WIN32)
</span><span>	</span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">CMAKE_CXX_FLAGS </span><span>&quot;$</span><span style="color:#a3be8c;">{</span><span style="color:#bf616a;">CMAKE_CXX_FLAGS</span><span style="color:#a3be8c;">} -std=c++14 -Wall -Wextra -fPIC</span><span>&quot;)
</span><span style="color:#b48ead;">endif</span><span>()
</span><span>
</span><span style="color:#b48ead;">IF </span><span>(NOT </span><span style="color:#bf616a;">DEFINED </span><span>BUILD_VERSION)
</span><span>	</span><span style="color:#96b5b4;">SET</span><span>(</span><span style="color:#bf616a;">BUILD_VERSION </span><span>&quot;</span><span style="color:#a3be8c;">not set</span><span>&quot;)
</span><span style="color:#b48ead;">ENDIF</span><span>()
</span><span style="color:#96b5b4;">ADD_DEFINITIONS</span><span>(-DBUILD_VERSION=&quot;$</span><span style="color:#a3be8c;">{</span><span style="color:#bf616a;">BUILD_VERSION</span><span style="color:#a3be8c;">}</span><span>&quot;)
</span><span>
</span><span style="color:#96b5b4;">find_package</span><span>(ament_cmake </span><span style="color:#bf616a;">REQUIRED</span><span>)
</span><span style="color:#96b5b4;">find_package</span><span>(rclcpp </span><span style="color:#bf616a;">REQUIRED</span><span>)
</span><span style="color:#96b5b4;">find_package</span><span>(rmw_implementation </span><span style="color:#bf616a;">REQUIRED</span><span>)
</span><span style="color:#96b5b4;">find_package</span><span>(std_msgs </span><span style="color:#bf616a;">REQUIRED</span><span>)
</span><span style="color:#96b5b4;">find_package</span><span>(Qt5Core </span><span style="color:#bf616a;">REQUIRED</span><span>)
</span><span style="color:#96b5b4;">find_package</span><span>(Qt5Quick </span><span style="color:#bf616a;">REQUIRED</span><span>)
</span><span>
</span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">CMAKE_AUTOMOC </span><span>ON)
</span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">CMAKE_AUTOUIC </span><span>ON)
</span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">CMAKE_AUTORCC </span><span>ON)
</span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">CMAKE_INCLUDE_CURRENT_DIR </span><span>ON)
</span><span>
</span><span>
</span><span style="color:#96b5b4;">include_directories</span><span>(
</span><span>	${</span><span style="color:#bf616a;">rclcpp_INCLUDE_DIRS</span><span>}
</span><span>	${</span><span style="color:#bf616a;">std_msgs_INCLUDE_DIRS</span><span>}
</span><span>	${</span><span style="color:#bf616a;">Qt5Core_INCLUDE_DIRS</span><span>}
</span><span>	${</span><span style="color:#bf616a;">Qt5Quick_INCLUDE_DIRS</span><span>}
</span><span>	)
</span><span>
</span><span style="color:#96b5b4;">file</span><span>(</span><span style="color:#bf616a;">GLOB </span><span>SOURCE_FILES
</span><span>	&quot;</span><span style="color:#a3be8c;">src/*.cpp</span><span>&quot;
</span><span>	)
</span><span>
</span><span style="color:#96b5b4;">add_executable</span><span>(${</span><span style="color:#bf616a;">PROJECT_NAME</span><span>} ${</span><span style="color:#bf616a;">SOURCE_FILES</span><span>} &quot;</span><span style="color:#a3be8c;">src/qml.qrc</span><span>&quot;)
</span><span>
</span><span style="color:#bf616a;">ament_target_dependencies</span><span>(${</span><span style="color:#bf616a;">PROJECT_NAME</span><span>}
</span><span>	rclcpp
</span><span>	std_msgs
</span><span>	rmw_implementation
</span><span>	)
</span><span style="color:#96b5b4;">target_link_libraries</span><span>(${</span><span style="color:#bf616a;">PROJECT_NAME</span><span>}
</span><span>	Qt5::Core
</span><span>	Qt5::Quick
</span><span>	)
</span><span>
</span><span style="color:#96b5b4;">install</span><span>(</span><span style="color:#bf616a;">TARGETS </span><span>${</span><span style="color:#bf616a;">PROJECT_NAME</span><span>} </span><span style="color:#bf616a;">DESTINATION </span><span>bin)
</span><span>
</span><span style="color:#bf616a;">ament_package</span><span>()
</span></code></pre>
<h3 id="step-3-create-a-package-xml-and-add-it-to-project">Step - 3: Create a <code>package.xml</code> and add it to project</h3>
<ul>
<li>
<p>ROS2 needs a package.xml to find build and execution dependencies and to state metadata.</p>
</li>
<li>
<p>A simple package.xml looks like this:</p>
</li>
</ul>
<pre data-lang="xml" style="background-color:#2b303b;color:#c0c5ce;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;?</span><span style="color:#bf616a;">xml </span><span style="color:#d08770;">version</span><span>=&quot;</span><span style="color:#a3be8c;">1.0</span><span>&quot;?&gt;
</span><span>&lt;?</span><span style="color:#bf616a;">xml-model </span><span style="color:#d08770;">href</span><span>=&quot;</span><span style="color:#a3be8c;">http://download.ros.org/schema/package_format2.xsd</span><span>&quot; </span><span style="color:#d08770;">schematypens</span><span>=&quot;</span><span style="color:#a3be8c;">http://www.w3.org/2001/XMLSchema</span><span>&quot;?&gt;
</span><span>&lt;</span><span style="color:#bf616a;">package </span><span style="color:#d08770;">format</span><span>=&quot;</span><span style="color:#a3be8c;">2</span><span>&quot;&gt;
</span><span>	&lt;</span><span style="color:#bf616a;">name</span><span>&gt;demo&lt;/</span><span style="color:#bf616a;">name</span><span>&gt;
</span><span>	&lt;</span><span style="color:#bf616a;">version</span><span>&gt;0.0.1&lt;/</span><span style="color:#bf616a;">version</span><span>&gt;
</span><span>	&lt;</span><span style="color:#bf616a;">description</span><span>&gt;A demo app for the blog&lt;/</span><span style="color:#bf616a;">description</span><span>&gt;
</span><span>	&lt;</span><span style="color:#bf616a;">maintainer </span><span style="color:#d08770;">email</span><span>=&quot;</span><span style="color:#a3be8c;">nope@notgoogle.com</span><span>&quot;&gt;Amar Lakshya&lt;/</span><span style="color:#bf616a;">maintainer</span><span>&gt;
</span><span>	&lt;</span><span style="color:#bf616a;">license</span><span>&gt;Apache License 2.0&lt;/</span><span style="color:#bf616a;">license</span><span>&gt;
</span><span>
</span><span>	&lt;</span><span style="color:#bf616a;">buildtool_depend</span><span>&gt;ament_cmake&lt;/</span><span style="color:#bf616a;">buildtool_depend</span><span>&gt;
</span><span>
</span><span>	&lt;</span><span style="color:#bf616a;">build_depend</span><span>&gt;rclcpp&lt;/</span><span style="color:#bf616a;">build_depend</span><span>&gt;
</span><span>	&lt;</span><span style="color:#bf616a;">build_depend</span><span>&gt;std_msgs&lt;/</span><span style="color:#bf616a;">build_depend</span><span>&gt;
</span><span>
</span><span>	&lt;</span><span style="color:#bf616a;">build_depend</span><span>&gt;qtbase5-dev&lt;/</span><span style="color:#bf616a;">build_depend</span><span>&gt;
</span><span>	&lt;</span><span style="color:#bf616a;">build_depend</span><span>&gt;qt5-qmake&lt;/</span><span style="color:#bf616a;">build_depend</span><span>&gt;
</span><span>
</span><span>	&lt;</span><span style="color:#bf616a;">exec_depend</span><span>&gt;libqt5-core&lt;/</span><span style="color:#bf616a;">exec_depend</span><span>&gt;
</span><span>	&lt;</span><span style="color:#bf616a;">exec_depend</span><span>&gt;rclcpp&lt;/</span><span style="color:#bf616a;">exec_depend</span><span>&gt;
</span><span>	&lt;</span><span style="color:#bf616a;">exec_depend</span><span>&gt;std_msgs&lt;/</span><span style="color:#bf616a;">exec_depend</span><span>&gt;
</span><span>
</span><span>	&lt;</span><span style="color:#bf616a;">export</span><span>&gt;
</span><span>		&lt;</span><span style="color:#bf616a;">build_type</span><span>&gt;ament_cmake&lt;/</span><span style="color:#bf616a;">build_type</span><span>&gt;
</span><span>	&lt;/</span><span style="color:#bf616a;">export</span><span>&gt;
</span><span>&lt;/</span><span style="color:#bf616a;">package</span><span>&gt;
</span></code></pre>
<h3 id="step-4-let-s-restructure-the-directory-to-clean-everything">Step - 4: Let's restructure the directory to clean everything.</h3>
<ul>
<li>First, create an <code>src</code> directory and move everything in it as a ROS2 package ( let's say <code>demo</code>) . Now, create an <code>src</code> directory and move all the <code>qml</code>, <code>cpp</code>, <code>qml.qrc</code> and <code>conf</code> files in that directory. Now your project folder should look something like this:</li>
</ul>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#96b5b4;">.
</span><span style="color:#bf616a;">└──</span><span> src
</span><span>    </span><span style="color:#bf616a;">└──</span><span> demo
</span><span>        </span><span style="color:#bf616a;">├──</span><span> CMakeLists.txt
</span><span>        </span><span style="color:#bf616a;">├──</span><span> demo.pro
</span><span>        </span><span style="color:#bf616a;">├──</span><span> demo.pro.user
</span><span>        </span><span style="color:#bf616a;">├──</span><span> package.xml
</span><span>        </span><span style="color:#bf616a;">└──</span><span> src
</span><span>            </span><span style="color:#bf616a;">├──</span><span> main.cpp
</span><span>            </span><span style="color:#bf616a;">├──</span><span> main.qml
</span><span>            </span><span style="color:#bf616a;">├──</span><span> Page1Form.ui.qml
</span><span>            </span><span style="color:#bf616a;">├──</span><span> Page2Form.ui.qml
</span><span>            </span><span style="color:#bf616a;">├──</span><span> qml.qrc
</span><span>            </span><span style="color:#bf616a;">└──</span><span> qtquickcontrols2.conf
</span><span>
</span><span style="color:#bf616a;">3</span><span> directories, 10 files
</span></code></pre>
<h3 id="step-5-all-set-time-to-build-the-package">Step - 5: All set, time to build the package!</h3>
<ul>
<li>Now, source your ROS2 workspace and run: <code>ament build</code>.</li>
</ul>
<p>Doing these steps, you should get a ROS2 Qt5 app package called <code>demo</code>.</p>
<h3 id="step-6-running-the-package-in-qtcreator">Step - 6: running the package in qtcreator!</h3>
<ul>
<li>
<p>Note that you will be easily able to run the package using ros2 commandline options, however, It would make our lives
incredibly easy to run and build our Qt5 app in the Qt Creator.</p>
<p>For that, first install the RTPS middleware system-wide by following directions on their project page: 
<a rel="noopener nofollow noreferrer" target="_blank" href="https://github.com/eProsima/Fast-RTPS#installation-from-source">RTPS Build instructions</a></p>
<p>and that's it! Now source your ROS2 workspace and go to your Qt5 app folder and just run <code>qtcreator</code>!</p>
<p>You will now be able to develop Qt5 apps with ROS2 in the Qt Creator</p>
</li>
</ul>
<p><strong>TIP</strong>: Here is the git-hosted <a rel="noopener nofollow noreferrer" target="_blank" href="https://github.com/amar-laksh/ros2qt_demo">sample project</a>.</p>

          </div>
        </article>
      </div>
      
    </div>
  </div>
</section>


  
  <section class="modal" id="search-modal">
    <div class="modal-background"></div>
    <div class="modal-card">
      <header class="modal-card-head">
        <p class="modal-card-title">Search</p>
      </header>
      <section class="modal-card-body">
        <div class="field mb-2">
          <div class="control">
            <input class="input" id="search" placeholder="Search this website." type="search" />
          </div>
        </div>
        <div class="search-results">
          <div class="search-results__items"></div>
        </div>
      </section>
    </div>
    <button aria-label="close" class="modal-close is-large"></button>
  </section>
  


  

<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <nav class="level">
          
          <div class="level-item has-text-centered">
            <a class="button is-black is-outlined" href="https:&#x2F;&#x2F;amar-laksh.github.io&#x2F;posts&#x2F;google-ctf-writeups-part-2&#x2F;">
              <span class="icon mr-2">
                <i class="fas fa-arrow-circle-left"></i>
              </span>
              Writeups for Google CTF 2019: My first CTF (Kinda) - Part 2
            </a>
          </div>
           
          <div class="level-item has-text-centered">
            <a class="button is-black is-outlined" href="https:&#x2F;&#x2F;amar-laksh.github.io&#x2F;posts&#x2F;beyond-good-and-evil&#x2F;">
              Beyond Good and Evil - A look at why to be neither<span class="icon ml-2">
                <i class="fas fa-arrow-circle-right"></i>
              </span>
            </a>
          </div>
            
        </nav>
      </div>
    </div>
  </div>
</section>



  



  <footer class="footer py-4">
    <div class="content has-text-centered">
      <p>
        Built with
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-code"></i>
          </span>
        </span>
        and
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-heart"></i>
          </span>
        </span>
      </p>
      <p>
        Powered by
        <span class="icon-text">
          <span class="icon">
            <i class="fas fa-power-off"></i>
          </span>
          <span>zola</span>
        </span>
      </p>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/galleria/1.6.1/galleria.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@8.9.2/dist/mermaid.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1.1.13/dist/chart.xkcd.min.js"></script>
  <script src='https://api.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js'></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/galleria/1.6.1/themes/folio/galleria.folio.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js"></script>
  <script src="https://amar-laksh.github.io/search_index.en.js"></script>
  <script src="https://amar-laksh.github.io/js/site.js"></script>

  




</body>

</html>
